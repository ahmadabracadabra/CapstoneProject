<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <link href="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.css" rel="stylesheet" />
    <title>Dashboard</title>
</head>
<body class="bg-gray-900 min-h-screen">
    <div class="antialiased bg-gray-50 dark:bg-gray-900">
        <nav class="bg-white border-b border-gray-200 px-4 py-2.5 dark:bg-gray-800 dark:border-gray-700 fixed left-0 right-0 top-0 z-50">
          <div class="flex flex-wrap justify-between items-center">
            <div class="flex justify-start items-center">
              <button
                data-drawer-target="drawer-navigation"
                data-drawer-toggle="drawer-navigation"
                aria-controls="drawer-navigation"
                class="p-2 mr-2 text-gray-600 rounded-lg cursor-pointer md:hidden hover:text-gray-900 hover:bg-gray-100 focus:bg-gray-100 dark:focus:bg-gray-700 focus:ring-2 focus:ring-gray-100 dark:focus:ring-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"
              >
                <svg
                  aria-hidden="true"
                  class="w-6 h-6"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fill-rule="evenodd"
                    d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h6a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                    clip-rule="evenodd"
                  ></path>
                </svg>
                <svg
                  aria-hidden="true"
                  class="hidden w-6 h-6"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fill-rule="evenodd"
                    d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                    clip-rule="evenodd"
                  ></path>
                </svg>
                <span class="sr-only">Toggle sidebar</span>
              </button>
              <a href="" class="flex items-center justify-between mr-4">
                <img
                  src="Images/graduating-student.png"
                  class="mr-3 h-8"
                  alt="Logo"
                />
                <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">SADAS</span>
              </a>
              <form action="#" method="GET" class="hidden md:block md:pl-2">
                <label for="topbar-search" class="sr-only">Search</label>
                <div class="relative md:w-64 md:w-96">
                  <div
                    class="flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"
                  >
                    <svg
                      class="w-5 h-5 text-gray-500 dark:text-gray-400"
                      fill="currentColor"
                      viewBox="0 0 20 20"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        fill-rule="evenodd"
                        clip-rule="evenodd"
                        d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                      ></path>
                    </svg>
                  </div>
                  <input
                    type="text"
                    name="email"
                    id="topbar-search"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                    placeholder="Search"
                  />
                </div>
              </form>
            </div>
            <div class="flex items-center lg:order-2">
              <button
                type="button"
                data-drawer-toggle="drawer-navigation"
                aria-controls="drawer-navigation"
                class="p-2 mr-1 text-gray-500 rounded-lg md:hidden hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-white dark:hover:bg-gray-700 focus:ring-4 focus:ring-gray-300 dark:focus:ring-gray-600"
              >
                <span class="sr-only">Toggle search</span>
                <svg aria-hidden="true" class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                  <path clip-rule="evenodd" fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"></path>
                </svg>
              </button>
              <!-- Notifications -->
              <button
                type="button"
                data-dropdown-toggle="notification-dropdown"
                class="p-2 mr-1 text-gray-500 rounded-lg hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-white dark:hover:bg-gray-700 focus:ring-4 focus:ring-gray-300 dark:focus:ring-gray-600"
              >
                <span class="sr-only">View notifications</span>
                <!-- Bell icon -->
                <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6" d="M12 5.365V3m0 2.365a5.338 5.338 0 0 1 5.133 5.368v1.8c0 2.386 1.867 2.982 1.867 4.175 0 .593 0 1.292-.538 1.292H5.538C5 18 5 17.301 5 16.708c0-1.193 1.867-1.789 1.867-4.175v-1.8A5.338 5.338 0 0 1 12 5.365ZM8.733 18c.094.852.306 1.54.944 2.112a3.48 3.48 0 0 0 4.646 0c.638-.572 1.236-1.26 1.33-2.112h-6.92Z"/>
                </svg>
                
                  <path
                    d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"
                  ></path>
                </svg>
              </button>
              <!-- Dropdown menu -->
                <div
                class="hidden overflow-hidden z-50 my-4 max-w-sm text-base list-none bg-white rounded divide-y divide-gray-100 shadow-lg dark:divide-gray-600 dark:bg-gray-700 rounded-xl"
                id="notification-dropdown"
                >
                <div class="block py-2 px-4 text-base font-medium text-center text-gray-700 bg-gray-50 dark:bg-gray-600 dark:text-gray-300">
                Notifications
                </div>
                <div id="notification-list">
                <!-- Notifications here -->
                </div>
                </div>

              <!-- avatar --> 
              <button
                type="button"
                class="flex mx-3 text-sm bg-gray-800 rounded-full md:mr-0 focus:ring-4 focus:ring-gray-300 dark:focus:ring-gray-600"
                id="user-menu-button"
                aria-expanded="false"
                data-dropdown-toggle="dropdown"
              >
                <span class="sr-only">Open user menu</span>
                <img
                  class="w-8 h-8 rounded-full"
                  src="Images/spongebob-avatar.jpeg"
                  alt="user photo"
                />
              </button>
              <!-- Dropdown menu -->
              <div
              class="hidden z-50 my-4 w-56 text-base list-none bg-white rounded divide-y divide-gray-100 shadow dark:bg-gray-700 dark:divide-gray-600 rounded-xl"
              id="dropdown"
              >
              <div class="py-3 px-4">
                <span
                  id="user-name"
                  class="block text-sm font-semibold text-gray-900 dark:text-white"
                  >Loading...</span
                >
                <span
                  id="user-email"
                  class="block text-sm text-gray-900 truncate dark:text-white"
                  >Loading...</span
                >
              </div>
              <ul class="py-1 text-gray-700 dark:text-gray-300" aria-labelledby="dropdown">
                <li>
                  <a
                    href="#"
                    class="block py-2 px-4 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-400 dark:hover:text-white"
                    >Profile</a
                  >
                </li>
                <li>
                  <a
                    href="#"
                    class="block py-2 px-4 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-400 dark:hover:text-white"
                    >Settings</a
                  >
                </li>
              </ul>
             
              <ul class="py-1 text-gray-700 dark:text-gray-300" aria-labelledby="dropdown">
                <li>
                  <a
                    href="#"
                    id="logoutButton"
                    class="block py-2 px-4 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white"
                    >Sign Out</a
                  >
                </li>
              </ul>
              </div>
            </div>
          </div>
        </nav>      

       <!-- Sidebar -->
<aside
class="fixed top-0 left-0 z-40 w-64 h-screen pt-14 transition-transform bg-white border-r border-gray-200 dark:bg-gray-800 dark:border-gray-700"
aria-label="Sidenav"
id="drawer-navigation"
>
<div class="overflow-y-auto py-5 px-3 h-full bg-white dark:bg-gray-800">
  <form action="#" method="GET" class="md:hidden mb-2">
    <label for="sidebar-search" class="sr-only">Search</label>
    <div class="relative">
      <div class="flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none">
        <svg class="w-5 h-5 text-gray-500 dark:text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"></path>
        </svg>
      </div>
      <input
        type="text"
        name="search"
        id="sidebar-search"
        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full pl-10 p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
        placeholder="Search"
      />
    </div>
  </form>
  <ul class="space-y-2">
    <li>
      <a href="dashboard.html" class="flex items-center p-2 text-base font-medium text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m4 12 8-8 8 8M6 10.5V19a1 1 0 0 0 1 1h3v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h3a1 1 0 0 0 1-1v-8.5"/>
        </svg>
        <span class="ml-3">Overview</span>
      </a>
    </li>
    <li>
      <a href="calendar.html" class="flex items-center p-2 w-full text-base font-medium text-gray-900 rounded-lg transition duration-75 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 10h16m-8-3V4M7 7V4m10 3V4M5 20h14a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Zm3-7h.01v.01H8V13Zm4 0h.01v.01H12V13Zm4 0h.01v.01H16V13Zm-8 4h.01v.01H8V17Zm4 0h.01v.01H12V17Zm4 0h.01v.01H16V17Z"/>
        </svg>
        <span class="flex-1 ml-3 text-left whitespace-nowrap">Calendar</span>
      </a>
    </li>
    <li>
      <a href="#" class="flex items-center p-2 w-full text-base font-medium text-gray-900 rounded-lg transition duration-75 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700">
        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 6H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1Zm7 11-6-2V9l6-2v10Z"/>
        </svg>
        <span class="flex-1 ml-3 text-left whitespace-nowrap">Video Chat</span>
      </a>
    </li>
    <li>
      <a href="messaging.html" class="flex items-center p-2 text-base font-medium text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17h6l3 3v-3h2V9h-2M4 4h11v8H9l-3 3v-3H4V4Z"/>
        </svg>
        <span class="flex-1 ml-3 whitespace-nowrap">Messages</span>
        <span class="inline-flex justify-center items-center w-5 h-5 text-xs font-semibold rounded-full text-primary-800 bg-primary-100 dark:bg-primary-200 dark:text-primary-800">
          4
        </span>
      </a>
    </li>
  </ul>
  <ul class="pt-5 mt-5 space-y-2 border-t border-gray-200 dark:border-gray-700">

    <li>
      <a href="#" class="flex items-center p-2 text-base font-medium text-gray-900 rounded-lg transition duration-75 hover:bg-gray-100 dark:hover:bg-gray-700 dark:text-white group">
        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
          <path stroke="currentColor" stroke-linecap="square" stroke-linejoin="round" stroke-width="2" d="M10 19H5a1 1 0 0 1-1-1v-1a3 3 0 0 1 3-3h2m10 1a3 3 0 0 1-3 3m3-3a3 3 0 0 0-3-3m3 3h1m-4 3a3 3 0 0 1-3-3m3 3v1m-3-4a3 3 0 0 1 3-3m-3 3h-1m4-3v-1m-2.121 1.879-.707-.707m5.656 5.656-.707-.707m-4.242 0-.707.707m5.656-5.656-.707.707M12 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/>
        </svg>
        <span class="ml-3">Settings</span>
      </a>
    </li>
    
    <li>
      <a href="#" class="flex items-center p-2 text-base font-medium text-gray-900 rounded-lg transition duration-75 hover:bg-gray-100 dark:hover:bg-gray-700 dark:text-white group">
        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 14v7M5 4.971v9.541c5.6-5.538 8.4 2.64 14-.086v-9.54C13.4 7.61 10.6-.568 5 4.97Z"/>
        </svg>
        <span class="ml-3">Help</span>
      </a>
    </li>
  </ul>
  </div>
</aside>
<!-- End Sidebar -->
<main class="p-4 md:ml-64 h-auto pt-20">
  <div id="welcomeMessage" class="">
    <div class="w-full p-8 text-center bg-white border border-gray-200 rounded-lg shadow-sm sm:p-8 dark:bg-gray-800 dark:border-gray-700">
      <h5 id="welcomeText" class="mb-2 text-3xl font-bold text-gray-900 dark:text-white"></h5>
      <p class="mb-5 text-base text-gray-500 sm:text-lg dark:text-gray-400">Are you ready to get your day started?</p>
      <div class="items-center justify-center space-y-4 sm:flex sm:space-y-0 sm:space-x-4 rtl:space-x-reverse">       
      </div>
    </div>

    <!-- Main grid layout for content -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-6">
      <!-- Tasks List -->
      <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md h-[400px] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold text-white">Tasks List</h3>
          <button class="bg-gray-700 text-white text-sm px-3 py-1 rounded cursor-pointer">Urgent</button>
        </div>
        <p class="text-gray-400 mb-3">Hello, here are your tasks for the day:</p>

        <!-- Form to add tasks -->
        <form id="task-form" class="mb-4 flex">
          <input type="text" id="task-input" class="p-2 border rounded-l w-full text-black" placeholder="New Task">
          <button type="submit" class="bg-blue-500 text-white p-2 rounded-r">Add</button>
        </form>
        <!-- Task list -->
        <ul id="task-list" class="space-y-3">
          <!-- Tasks added here -->
        </ul>
      </div>

      <!-- Upcoming Assignments -->
      <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md h-[400px] overflow-y-auto">
        <h3 class="text-xl font-medium dark:text-white">Upcoming Assignments</h3>
        <ul id="assignments-list" class="space-y-4 mt-4">
          <!-- Assignments will go here -->
        </ul>
      </div>

      <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md h-[450px] overflow-y-auto flex flex-col justify-between">
        <h3 class="text-xl font-medium mb-4 dark:text-white">Add New Assignment</h3>
        <form id="assignment-form" class="space-y-4 flex-1">
          <input type="text" id="title" placeholder="Assignment Title" class="w-full p-2 border rounded-md" required>
      
          <!-- Flex container for Class Name and Due Date -->
          <div class="flex space-x-4">
            <input type="text" id="class-name" placeholder="Class Name" class="w-[48%] p-2 border rounded-md" required>
            <input type="date" id="due-date" class="w-[48%] p-2 border rounded-md" required>
          </div>
          
      
          <textarea id="description" placeholder="Description" class="w-full p-2 border rounded-md" rows="4"></textarea>
      
          <!-- Flex container to align Status and Points next to each other -->
          <div class="flex space-x-4">
            <select id="status" class="flex-1 p-2 border rounded-md" required>
              <option value="Unstarted">Unstarted</option>
              <option value="In Progress">In Progress</option>
              <option value="Done">Done</option>
            </select>
      
            <input type="number" id="points-possible" placeholder="Points Possible" class="flex-1 p-2 border rounded-md" required>
          </div>
      
          <button type="submit" class="w-full bg-blue-500 text-white p-2 rounded-md">Add Assignment</button>
        </form>
      </div>
      

      <!-- Upcoming Events -->
      <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md h-[150px] overflow-y-auto">
        <h2 class="text-lg font-semibold text-gray-700 dark:text-white">üìÖ Upcoming Events</h2>
        <ul class="mt-2 text-gray-600 dark:text-gray-300" id="events-list">
          <!-- Events inserted here -->
        </ul>
      </div>

      <!-- Daily Motivation -->
      <div class="bg-purple-100 dark:bg-purple-900 p-4 rounded-xl shadow-md h-[150px] overflow-y-auto">
        <h2 class="text-lg font-semibold text-purple-700 dark:text-purple-300">‚ú® Daily Motivation</h2>
        <p id="quote" class="mt-2 text-purple-600 dark:text-purple-200 italic">
          <!-- The quote will be inserted here -->
        </p>
      </div>

      <!-- Timer -->
      <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md text-center h-[180px] overflow-y-auto">
        <h2 class="text-lg font-semibold text-gray-700 dark:text-white">‚è≥ Study Timer</h2>
        <p id="timer-display" class="text-4xl font-bold mt-2 text-gray-900 dark:text-gray-100">25:00</p>
        <div class="mt-4">
          <button id="start-btn" class="bg-green-800 text-white px-4 py-2 rounded-lg mr-2">‚ñ∂ Start</button>
          <button id="pause-btn" class="bg-yellow-600 text-white px-4 py-2 rounded-lg mr-2">‚è∏ Pause</button>
          <button id="reset-btn" class="bg-red-800 text-white px-4 py-2 rounded-lg">üîÑ Reset</button>
        </div>
      </div>
    </div>
  </div>
</main>



        <script>
            let timer;
            let timeLeft = 25 * 60; // 25 minutes in seconds
            let isRunning = false;
        
            function updateDisplay() {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById("timer-display").textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
        
            document.getElementById("start-btn").addEventListener("click", function() {
                if (!isRunning) {
                    isRunning = true;
                    timer = setInterval(() => {
                        if (timeLeft > 0) {
                            timeLeft--;
                            updateDisplay();
                        } else {
                            clearInterval(timer);
                            alert("‚è≥ Time‚Äôs up! Take a break!");
                            isRunning = false;
                        }
                    }, 1000);
                }
            });
        
            document.getElementById("pause-btn").addEventListener("click", function() {
                clearInterval(timer);
                isRunning = false;
            });
        
            document.getElementById("reset-btn").addEventListener("click", function() {
                clearInterval(timer);
                timeLeft = 25 * 60;
                updateDisplay();
                isRunning = false;
            });
        
            updateDisplay();
        </script>
        
      
          </div>
        </main>
      </div>  
    
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const taskForm = document.getElementById('task-form');
        const taskList = document.getElementById('task-list');
    
        if (taskForm) {
            taskForm.addEventListener('submit', addTask);
        } else {
            console.error("task-form not found in DOM.");
        }
    
        if (taskList) {
            fetchAllTasks();
        } else {
            console.error("task-list not found in DOM.");
        }
      });
    
      // fetch and display tasks
      async function fetchAllTasks() {
        const token = localStorage.getItem('token');
        if (!token) {
            console.error("No token found in localStorage");
            return;
        }
    
        try {
          //const response = await fetch('http://35.174.153.248:8080/tasks', {
            const response = await fetch('http://localhost:8080/tasks', {
                method: 'GET',
                headers: { 
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                }
            });
    
            if (!response.ok) throw new Error("Failed to fetch tasks");
    
            const tasks = await response.json();
            const taskList = document.getElementById('task-list');
            taskList.innerHTML = '';
    
            tasks.forEach(task => {
                taskList.appendChild(createTaskElement(task));
            });
        } catch (error) {
            console.error("Error fetching tasks:", error);
        }
      }
    
      // add a new task
      async function addTask(event) {
        event.preventDefault();
        const taskInput = document.getElementById('task-input');
        const taskText = taskInput.value.trim();
        const token = localStorage.getItem('token');
    
        if (!taskText || !token) return;
    
        try {
          // const response = await fetch('http://35.174.153.248:8080/tasks', {
            const response = await fetch('http://localhost:8080/tasks', {
                method: 'POST',
                headers: { 
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ task: taskText })
            });
    
            if (!response.ok) throw new Error("Failed to create task");
    
            const newTask = await response.json();
            document.getElementById('task-list').appendChild(createTaskElement(newTask));
            taskInput.value = '';
        } catch (error) {
            console.error("Error creating task:", error);
        }
      }
    
      // remove a task
      async function removeTask(taskId, taskElement) {
        const token = localStorage.getItem('token');
    
        try {
          // const response = await fetch(`http://35.174.153.248:8080/tasks/${taskId}`, {
            const response = await fetch(`http://localhost:8080/tasks/${taskId}`, {
                method: 'DELETE',
                headers: { 'Authorization': `Bearer ${token}` }
            });
    
            if (!response.ok) throw new Error("Failed to delete task");
    
            taskElement.remove();
        } catch (error) {
            console.error("Error deleting task:", error);
        }
      }
    
      // Function to create a task element
      function createTaskElement(task) {
        if (!task.id) {
            console.error("Task ID missing:", task);
            return;
        }
    
        const taskItem = document.createElement('div');
        taskItem.className = 'task-item flex items-center justify-between p-3 bg-gray-100 rounded';
        taskItem.dataset.id = task.id;
    
        const taskText = document.createElement('span');
        taskText.className = 'task-text text-gray-800';
        taskText.textContent = task.task || task.task_text; 
    
        const deleteButton = document.createElement('button');
        deleteButton.className = 'delete-task text-gray-500 hover:text-red-500';
        deleteButton.innerHTML = `
            <svg class="w-6 h-6 text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"/>
            </svg>
        `;
    
        deleteButton.addEventListener('click', () => removeTask(task.id, taskItem));
    
        taskItem.appendChild(taskText);
        taskItem.appendChild(deleteButton);
    
        return taskItem;
      }
    </script>
    
    <script>
      async function fetchDailyQuote() {
        const token = localStorage.getItem('token');
        if (!token) {
            console.error("No token found in localStorage");
            return;
        }
          try {
            //const response = await fetch('http://35.174.153.248:8080/quote', {
              const response = await fetch('http://localhost:8080/quote', {
                  method: 'GET', 
                  headers: {
                      'Authorization': `Bearer ${token}`, 
                      'Content-Type': 'application/json', 
                  },
              });
              if (!response.ok) {
                  throw new Error('Failed to fetch the quote');
              }
              const data = await response.json();
              const quote = data.quote; 
              document.getElementById('quote').textContent = `"${quote}"`; 
          } catch (error) {
              console.error('Error fetching daily quote:', error);
          }
      }
  
      document.addEventListener('DOMContentLoaded', fetchDailyQuote);
  </script>
  
  <script>
    async function getUserData() {
        const token = localStorage.getItem('token');
        if (!token) {
            window.location.href = '/login';  
            return;
        }

        try {
            const response = await fetch('http://localhost:8080/dashboard', {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json',
                }
            });

            if (!response.ok) throw new Error('Failed to fetch user data');

            const user = await response.json();
            console.log(user);  

            document.getElementById("user-name").textContent = user.username || "Unknown User";
            document.getElementById("user-email").textContent = user.email || "user@example.com";
            document.getElementById("welcomeText").textContent = `Welcome Back, ${user.username || "User"}`;

        } catch (error) {
            console.error('Error fetching user data:', error);
        }
    }

    function formatEventDate(dateString) {
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        const eventDate = new Date(dateString);
        return eventDate.toLocaleDateString('en-US', options);
    }

    async function fetchUpcomingEvents() {
        const token = localStorage.getItem('token');
        if (!token) {
            window.location.href = '/login';  
            return;
        }

        try {
            const response = await fetch('http://localhost:8080/events', {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json',
                }
            });

            if (!response.ok) throw new Error('Failed to fetch events');

            const events = await response.json();

            const eventsList = document.getElementById('events-list');
            eventsList.innerHTML = '';  

            events.forEach(event => {
                const listItem = document.createElement('li');
                const formattedDate = formatEventDate(event.event_date);  
                listItem.textContent = `${event.name} (${formattedDate})`; 
                eventsList.appendChild(listItem);
            });

        } catch (error) {
            console.error('Error fetching events:', error);
        }
    }

    async function postAssignment(event) {
        event.preventDefault();

        const title = document.getElementById("title").value;
        const dueDate = document.getElementById("due-date").value;
        const className = document.getElementById("class-name").value;
        const description = document.getElementById("description").value;
        const status = document.getElementById("status").value;
        const pointsPossible = document.getElementById("points-possible").value;

        console.log(title, dueDate, className, description, status, pointsPossible);

        const token = localStorage.getItem("token");

        try {
            const response = await fetch("http://localhost:8080/assignments", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${token}`,
                },
                body: JSON.stringify({
                    title, className, dueDate, description, status, pointsPossible
                }),
            });

            const data = await response.json();

            if (response.ok) {
                alert("Assignment created successfully!");
                await fetchAssignments();
            } else {
                alert("Error: " + data.error);
            }
        } catch (error) {
            console.error("Error creating assignment:", error);
        }
    }

    async function fetchAssignments() {
    const token = localStorage.getItem("token");
    try {
        const response = await fetch("http://localhost:8080/assignments", {
            method: "GET",
            headers: {
                "Authorization": `Bearer ${token}`
            }
        });

        const assignments = await response.json();
        const assignmentList = document.getElementById("assignments-list");
        assignmentList.innerHTML = "";  

        // Sort the assignments by due date 
        assignments.sort((a, b) => {
            const dueDateA = new Date(a.DueDate);
            const dueDateB = new Date(b.DueDate);
            return dueDateA - dueDateB;  // ascending
        });

        assignments.forEach(assignment => {
            const assignmentCard = createAssignmentCard(assignment);
            assignmentList.appendChild(assignmentCard);
        });
    } catch (error) {
        console.error("Error fetching assignments:", error);
    }
}

    async function deleteAssignment(assignmentId) {
        const token = localStorage.getItem("token");
        if (!confirm("Are you sure you want to delete this assignment?")) return;

        try {
            const response = await fetch(`http://localhost:8080/assignments/${assignmentId}`, {
                method: "DELETE",
                headers: {
                    "Authorization": `Bearer ${token}`
                }
            });

            const data = await response.json();

            if (response.ok) {
                alert("Assignment deleted successfully!");
                await fetchAssignments();
            } else {
                alert("Error: " + data.error);
            }
        } catch (error) {
            console.error("Error deleting assignment:", error);
        }
    }

    function updateStatus(assignmentId) {
        const statusSelect = document.getElementById(`status-select-${assignmentId}`);
        const newStatus = statusSelect.value;

        fetch(`http://localhost:8080/assignments/${assignmentId}/status`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${localStorage.getItem('token')}`
            },
            body: JSON.stringify({ status: newStatus })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const assignmentCard = document.getElementById(`assignment-card-${assignmentId}`);
                updateCardStatusAndColor(assignmentCard, newStatus);
                alert('Status updated successfully!');
            } else {
                alert('Failed to update status');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Failed to update status');
        });
    }

    function updateCardStatusAndColor(cardElement, newStatus) {
        const statusElement = cardElement.querySelector('.assignment-status');
        statusElement.textContent = newStatus;

        let cardColorClass = "bg-gray-500";
        if (newStatus === "Unstarted") cardColorClass = "bg-yellow-500";
        if (newStatus === "In Progress") cardColorClass = "bg-blue-500";
        if (newStatus === "Done") cardColorClass = "bg-green-500";

        cardElement.classList.remove("bg-yellow-500", "bg-blue-500", "bg-green-500", "bg-gray-500");
        cardElement.classList.add(cardColorClass);
    }

    function createAssignmentCard(assignment) {
        const li = document.createElement("li");
        li.className = `assignment-card rounded-md mb-4 p-4 text-white relative`;

        const formattedDate = new Date(assignment.DueDate).toLocaleDateString('en-US', {
            month: 'long',
            day: 'numeric',
            year: 'numeric'
        });

        let cardColorClass = "bg-gray-500";
        if (assignment.Status === "Unstarted") cardColorClass = "bg-yellow-500";
        if (assignment.Status === "In Progress") cardColorClass = "bg-blue-500";
        if (assignment.Status === "Done") cardColorClass = "bg-green-500";

        li.id = `assignment-card-${assignment.AssignmentID}`;

        li.innerHTML = `
    <div class="flex justify-between items-start w-full" id="assignment-card-${assignment.AssignmentID}">
        <div class="flex flex-col items-start">
            <span class="font-bold text-lg">${assignment.Title}</span>
            <span class="text-sm text-white">${assignment.Class}</span>
        </div>
        <button class="text-xl bg-transparent text-white" onclick="deleteAssignment(${assignment.AssignmentID})">X</button>
    </div>
    <div class="mt-1 text-sm">
        <div class="flex items-center">
            <span>${assignment.Points_Possible} pts</span>
            <span class="mx-2">‚Ä¢</span>
            <span>${formattedDate}</span>
        </div>
    </div>
    <div class="description-toggle absolute bottom-4 right-4 text-3xl cursor-pointer">‚ò∞</div>
    <div class="description-content mt-2 text-gray-200 hidden">
        <p>${assignment.Description}</p>
        <!-- Add hidden class to the redundant status label -->
        <div class="mt-2 text-sm font-semibold assignment-status hidden">Status: ${assignment.Status}</div> 
        <div class="mt-2 text-sm font-semibold">
            <label for="status-select-${assignment.AssignmentID}">Status: </label>
            <select id="status-select-${assignment.AssignmentID}" class="status-select" onchange="updateStatus(${assignment.AssignmentID})">
                <option value="Unstarted" ${assignment.Status === 'Unstarted' ? 'selected' : ''}>Unstarted</option>
                <option value="In Progress" ${assignment.Status === 'In Progress' ? 'selected' : ''}>In Progress</option>
                <option value="Done" ${assignment.Status === 'Done' ? 'selected' : ''}>Done</option>
            </select>
        </div>
    </div>
`;



        li.classList.add(cardColorClass);

        const descriptionToggle = li.querySelector(".description-toggle");
        const descriptionContent = li.querySelector(".description-content");

        descriptionToggle.addEventListener("click", () => {
            descriptionContent.classList.toggle("hidden");
        });

        return li;
    }

    document.addEventListener("DOMContentLoaded", async () => {
        await getUserData();
        await fetchUpcomingEvents();
        await fetchAssignments();
    });

    document.getElementById("assignment-form").addEventListener("submit", postAssignment);
</script>
    
  
  <script> 
  //logout stuff
  document.getElementById("logoutButton").addEventListener("click", async function (event) {
  event.preventDefault(); 

  try {
    const token = localStorage.getItem("token");

    const response = await fetch("http://localhost:8080/logout", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${token}`, 
      },
    });

    if (response.ok) {
      localStorage.removeItem("token");
      sessionStorage.removeItem("token");

      window.location.href = "login.html"; 
    } else {
      console.error("Logout failed:", await response.json());
    }
  } catch (error) {
    console.error("Error during logout:", error);
  }
});
  </script>




      
 <script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>   




</body>
</html>
